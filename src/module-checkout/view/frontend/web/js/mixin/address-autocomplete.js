define(["jquery","uiRegistry","Dholi_GoogleGeolocation/js/model/google-places","underscore"],function(d,a,c,b){return function(f){const i="google-autocomple";const g={street_number:{g:"long_name",m:"street.1"},route:{g:"long_name",m:"street.0"},administrative_area_level_2:{g:"long_name",m:"city"},administrative_area_level_1:{g:"long_name",m:"region"},country:{g:"short_name",m:"country_id"},postal_code:{g:"short_name",m:"postcode"}};var e=function(k,j){try{let prefix="checkout.steps.".concat(k.concat("."));let fieldId=a.get(prefix.concat(j)).uid;let input=d("#"+fieldId);if(input){if(input.attr("type")=="text"){input.val("").trigger("change")}}}catch(l){}};var h=function(k,j,l){let fieldId=null;let prefix="checkout.steps.".concat(k.concat("."));if(j=="region"){if(l!=""){if(a.get(prefix.concat("region_id"))){fieldId=a.get(prefix.concat("region_id")).uid;if(d("#"+fieldId)){d("#"+fieldId+" option").filter(function(){return d.trim(d(this).text())==l}).attr("selected",true);d("#"+fieldId).trigger("change")}}if(a.get(prefix.concat("region_id_input"))){fieldId=a.get(prefix.concat("region_id_input")).uid;if(d("#"+fieldId)){d("#"+fieldId).val(l).trigger("change")}}}}else{fieldId=a.get(prefix.concat(j)).uid;if(d("#"+fieldId)){d("#"+fieldId).val(l).trigger("change")}}};let addressAutoFill=function(j){let address=JSON.parse(d.cookie("dholi-address-information"));d("#"+j).value(address.postcode)};a.async("checkoutProvider")(function(j){j.on("shippingAddress",function(k){d('#shipping-new-address-form input[name="street[0]"]').each(function(l){try{if(!d(this).data(i)){d(this).data(i,true);if(window.dholiGoogleGeolocation.isGooglePlacesAutocompleteActived){let autocomplete=c.initAutocomplete(d(this).attr("id"));autocomplete.addListener("place_changed",function(){let prefix="shipping-step.shippingAddress.shipping-address-fieldset";let place=autocomplete.getPlace();if(place&&b.size(place.address_components)>0){b.each(g,function(o,n){e(prefix,o.m)});b.each(place.address_components,function(o,n){let addressType=o.types[0];if(b.has(g,addressType)){let field=b.propertyOf(g)(addressType);let value=b.propertyOf(o)(field.g);h(prefix,field.m,value)}})}})}}}catch(m){}})});Object.getOwnPropertyNames(j).forEach(function(l,k,m){if(l.indexOf("billingAddress")>-1){j.on(l,function(n){try{let uiIndex=l.replace("billingAddress","");let streetid=a.get("checkout.steps.billing-step.payment.payments-list."+uiIndex+"-form.form-fields.street.0").uid;if(!d("#".concat(streetid)).data(i)){d("#".concat(streetid)).data(i,true);let autocomplete=c.initAutocomplete(streetid);autocomplete.addListener("place_changed",function(){let prefix="billing-step.payment.payments-list."+uiIndex+"-form.form-fields";let place=autocomplete.getPlace();if(place&&b.size(place.address_components)>0){b.each(g,function(q,p){e(prefix,q.m)});b.each(place.address_components,function(q,p){let addressType=q.types[0];if(b.has(g,addressType)){let field=b.propertyOf(g)(addressType);let value=b.propertyOf(q)(field.g);h(prefix,field.m,value)}})}})}}catch(o){}})}})});return f}});